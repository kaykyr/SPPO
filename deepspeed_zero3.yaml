zero_optimization:
  stage: 3
  contiguous_gradients: true
  overlap_comm: true
  reduce_bucket_size: 5e7
  allgather_bucket_size: 5e7
  reduce_scatter: true
  offload_optimizer:
    device: "cpu"
    pin_memory: true
  offload_param:
    device: "cpu"
    pin_memory: true

bf16:
  enabled: auto

fp16:
  enabled: auto

zero_allow_untested_optimizer: true

train_batch_size: 2
gradient_accumulation_steps: 4
